    Order Id  Order Customer Id  Order Item Id  Order Item Product Price  Department Id  Order Item Quantity  Category Id  shipping_month  Benefit per order  Order Item Total  Product Card Id  Product Name  Order Item Cardprod Id  Order State  Product Category Id  order_week_day  shipping_year  Category Name  order_month  order_year  Order Item Discount  Department Name  Market  Order City  Days for shipment (scheduled)  Customer Segment  Customer Full Name       Sales
0    75939.0            19492.0       179254.0                327.750000            2.0                  1.0         73.0             1.0        -249.089996        311.359985           1360.0          78.0                  1360.0        841.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            16.389999              4.0     3.0       391.0                            4.0               0.0              5378.0  327.750000
1    75938.0            19491.0       179253.0                327.750000            2.0                  1.0         73.0             1.0        -247.779999        309.720001           1360.0          78.0                  1360.0        841.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            18.030001              4.0     3.0       391.0                            4.0               0.0              4429.0  327.750000
2    75927.0            19480.0       179242.0                327.750000            2.0                  1.0         73.0             1.0          24.580000        245.809998           1360.0          78.0                  1360.0        610.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            81.940002              4.0     3.0      2846.0                            1.0               1.0             10204.0  327.750000
3    75926.0            19479.0       179241.0                327.750000            2.0                  1.0         73.0             1.0          16.389999        327.750000           1360.0          78.0                  1360.0        610.0                 73.0             2.0         2018.0           40.0          1.0      2018.0             0.000000              4.0     3.0      2846.0                            1.0               1.0              7282.0  327.750000
4    75925.0            19478.0       179240.0                327.750000            2.0                  1.0         73.0             1.0        -259.579987        324.470001           1360.0          78.0                  1360.0        610.0                 73.0             2.0         2018.0           40.0          1.0      2018.0             3.280000              4.0     3.0      2846.0                            1.0               1.0             11918.0  327.750000
5    75923.0            19476.0       179238.0                327.750000            2.0                  1.0         73.0             1.0          23.840000        317.920013           1360.0          78.0                  1360.0        606.0                 73.0             2.0         2018.0           40.0          1.0      2018.0             9.830000              4.0     3.0      1477.0                            1.0               1.0              2609.0  327.750000
6    75922.0            19475.0       179237.0                327.750000            2.0                  1.0         73.0             1.0         102.260002        314.640015           1360.0          78.0                  1360.0        606.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            13.110000              4.0     3.0      1477.0                            1.0               0.0              1479.0  327.750000
7    75921.0            19474.0       179236.0                327.750000            2.0                  1.0         73.0             1.0          87.180000        311.359985           1360.0          78.0                  1360.0        606.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            16.389999              4.0     3.0      1477.0                            0.0               0.0              7271.0  327.750000
8    75920.0            19473.0       179235.0                327.750000            2.0                  1.0         73.0             1.0         154.860001        309.720001           1360.0          78.0                  1360.0        606.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            18.030001              4.0     3.0      1477.0                            0.0               1.0              7058.0  327.750000
9    75919.0            19472.0       179234.0                327.750000            2.0                  1.0         73.0             1.0          82.300003        304.809998           1360.0          78.0                  1360.0        606.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            22.940001              4.0     3.0      1477.0                            4.0               1.0               382.0  327.750000
10   75909.0            19462.0       179224.0                327.750000            2.0                  1.0         73.0             1.0         113.070000        245.809998           1360.0          78.0                  1360.0        280.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            81.940002              4.0     3.0       873.0                            4.0               0.0              6207.0  327.750000
11   75908.0            19461.0       179223.0                327.750000            2.0                  1.0         73.0             1.0          24.580000        327.750000           1360.0          78.0                  1360.0        280.0                 73.0             2.0         2018.0           40.0          1.0      2018.0             0.000000              4.0     3.0       873.0                            4.0               0.0              1225.0  327.750000
12   75904.0            19457.0       179219.0                327.750000            2.0                  1.0         73.0             1.0         151.029999        314.640015           1360.0          78.0                  1360.0        515.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            13.110000              4.0     3.0      1393.0                            1.0               1.0              7834.0  327.750000
13   75895.0            19448.0       179210.0                327.750000            2.0                  1.0         73.0             1.0          86.169998        275.309998           1360.0          78.0                  1360.0        515.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            52.439999              4.0     3.0       270.0                            4.0               1.0             12578.0  327.750000
14   75894.0            19447.0       179209.0                327.750000            2.0                  1.0         73.0             1.0         130.580002        272.029999           1360.0          78.0                  1360.0        515.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            55.720001              4.0     3.0       270.0                            2.0               1.0              8313.0  327.750000
15   28744.0             9083.0        71956.0                 59.990002            4.0                  2.0         17.0             2.0         -30.750000        115.180000            365.0          71.0                   365.0       1019.0                 17.0             6.0         2016.0           12.0          2.0      2016.0             4.800000              0.0     3.0      2098.0                            2.0               2.0              8888.0  119.980003
16   20365.0             8011.0        50842.0                 50.000000            5.0                  2.0         24.0            10.0           6.150000         82.000000            502.0          59.0                   502.0        841.0                 24.0             3.0         2015.0           47.0         10.0      2015.0            18.000000              6.0     3.0      2617.0                            2.0               2.0              8993.0  100.000000
17   25163.0             5801.0        63064.0                129.990005            4.0                  1.0         18.0             1.0          15.440000        123.489998            403.0          56.0                   403.0        270.0                 18.0             3.0         2016.0           34.0          1.0      2016.0             6.500000              0.0     3.0       840.0                            4.0               1.0             13096.0  129.990005
18   28036.0              702.0        70143.0                129.990005            4.0                  1.0         18.0             2.0           4.570000        123.489998            403.0          56.0                   403.0       1019.0                 18.0             3.0         2016.0           34.0          2.0      2016.0             6.500000              0.0     3.0      1574.0                            4.0               1.0              2837.0  129.990005
19   22019.0             9494.0        55063.0                129.990005            4.0                  1.0         18.0            11.0          39.919998        122.839996            403.0          56.0                   403.0        610.0                 18.0             6.0         2015.0           34.0         11.0      2015.0             7.150000              0.0     3.0      3275.0                            4.0               1.0             11594.0  129.990005
20   24063.0             8358.0        60210.0                129.990005            4.0                  1.0         18.0            12.0        -187.380005        120.889999            403.0          56.0                   403.0        841.0                 18.0             0.0         2015.0           34.0         12.0      2015.0             9.100000              0.0     3.0        41.0                            4.0               1.0              9384.0  129.990005
21   51209.0             7705.0       127964.0                129.990005            4.0                  1.0         18.0             1.0          31.430000        120.889999            403.0          56.0                   403.0        529.0                 18.0             5.0         2017.0           34.0          1.0      2017.0             9.100000              0.0     3.0      1613.0                            4.0               1.0              6619.0  129.990005
22   73839.0            17392.0       177154.0                215.820007            4.0                  1.0         76.0            12.0        -140.500000        200.710007           1363.0          81.0                  1363.0        398.0                 76.0             6.0         2017.0           48.0         12.0      2017.0            15.110000              0.0     3.0      3299.0                            4.0               1.0             10737.0  215.820007
23   75892.0            19445.0       179207.0                327.750000            2.0                  1.0         73.0             1.0         -45.889999        262.200012           1360.0          78.0                  1360.0        222.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            65.550003              4.0     3.0       378.0                            4.0               1.0              4116.0  327.750000
24   75889.0            19442.0       179204.0                327.750000            2.0                  1.0         73.0             1.0          24.340000        324.470001           1360.0          78.0                  1360.0        423.0                 73.0             0.0         2018.0           40.0          1.0      2018.0             3.280000              4.0     3.0      1341.0                            4.0               1.0              7679.0  327.750000
25   75888.0            19441.0       179203.0                327.750000            2.0                  1.0         73.0             1.0         -36.299999        321.200012           1360.0          78.0                  1360.0        423.0                 73.0             0.0         2018.0           40.0          1.0      2018.0             6.560000              4.0     3.0      1341.0                            4.0               1.0             13837.0  327.750000
26   75887.0            19440.0       179202.0                327.750000            2.0                  1.0         73.0             1.0         111.269997        317.920013           1360.0          78.0                  1360.0        423.0                 73.0             0.0         2018.0           40.0          1.0      2018.0             9.830000              4.0     3.0      1341.0                            4.0               1.0              5994.0  327.750000
27   75879.0            19432.0       179194.0                327.750000            2.0                  1.0         73.0             1.0         136.869995        285.140015           1360.0          78.0                  1360.0        606.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            42.610001              4.0     3.0      3273.0                            4.0               1.0             10421.0  327.750000
28   75878.0            19431.0       179193.0                327.750000            2.0                  1.0         73.0             1.0          20.889999        278.589996           1360.0          78.0                  1360.0        606.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            49.160000              4.0     3.0      3273.0                            4.0               1.0              9511.0  327.750000
29   75873.0            19426.0       179188.0                327.750000            2.0                  1.0         73.0             1.0        -163.960007        245.809998           1360.0          78.0                  1360.0        610.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            81.940002              4.0     3.0      2581.0                            4.0               0.0              2875.0  327.750000
torch.Size([5411, 27])
torch.Size([5411])
torch.Size([2320, 27])
torch.Size([2320])
Epoch 1/40, Loss: 57630.9630
Performance Metrics:
RMSE (test data): 239.69796691184135
MAE (test data): 199.42274823274863
MAPE (test data): 99.95586895851685
MSE (test data): 57455.115341670185
R2 (test data): -2.247659099681972
loss (test data): 57058.87376077586
Epoch 2/40, Loss: 57592.0081
Performance Metrics:
RMSE (test data): 239.28961403049087
MAE (test data): 199.16350138449343
MAPE (test data): 99.95665174741397
MSE (test data): 57259.5193828613
R2 (test data): -2.2468005215800155
loss (test data): 56864.62629310345
Epoch 3/40, Loss: 57506.5523
Performance Metrics:
RMSE (test data): 239.5251724627852
MAE (test data): 199.4978588546154
MAPE (test data): 99.96310257484286
MSE (test data): 57372.308243326996
R2 (test data): -2.248451194367325
loss (test data): 56976.63728448276
Epoch 4/40, Loss: 57459.2879
Performance Metrics:
RMSE (test data): 239.111221325529
MAE (test data): 199.2668008958701
MAPE (test data): 99.96926855944298
MSE (test data): 57174.176163786105
R2 (test data): -2.243944454857962
loss (test data): 56779.871066810345
Epoch 5/40, Loss: 57339.9851
Performance Metrics:
RMSE (test data): 238.29213214390006
MAE (test data): 198.60281629986196
MAPE (test data): 100.02108647313625
MSE (test data): 56783.140241685935
R2 (test data): -2.231342619721499
loss (test data): 56391.5328125
Epoch 6/40, Loss: 57162.0260
Performance Metrics:
RMSE (test data): 238.5367797676543
MAE (test data): 198.92068436504795
MAPE (test data): 100.07517194751736
MSE (test data): 56899.795301922415
R2 (test data): -2.220424255130104
loss (test data): 56507.382785560345
Epoch 7/40, Loss: 57063.4320
Performance Metrics:
RMSE (test data): 238.10692258195675
MAE (test data): 198.72431226671
MAPE (test data): 100.22841332478623
MSE (test data): 56694.90658144994
R2 (test data): -2.2103520144688633
loss (test data): 56303.90657327586
Epoch 8/40, Loss: 56888.9316
Performance Metrics:
RMSE (test data): 237.3062671484018
MAE (test data): 198.39373949828507
MAPE (test data): 100.38472778158152
MSE (test data): 56314.26442790863
R2 (test data): -2.2102096894317595
loss (test data): 55925.89035560345
Epoch 9/40, Loss: 56632.7506
Performance Metrics:
RMSE (test data): 236.93736631293322
MAE (test data): 198.17545224679634
MAPE (test data): 100.71175508992307
MSE (test data): 56139.3155553091
R2 (test data): -2.1892126643269436
loss (test data): 55752.14757543104
Traceback (most recent call last):
  File "/Users/yunbo/Documents/GitHub/PFL_Optimiozation/Local_learning/Transformer_local.py", line 239, in <module>
    loss.backward()
  File "/Users/yunbo/anaconda3/envs/basic/lib/python3.9/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/Users/yunbo/anaconda3/envs/basic/lib/python3.9/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/Users/yunbo/anaconda3/envs/basic/lib/python3.9/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt