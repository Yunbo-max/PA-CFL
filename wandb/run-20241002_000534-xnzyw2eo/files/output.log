    Order Id  Order Customer Id  Order Item Id  Order Item Product Price  Department Id  Order Item Quantity  Category Id  shipping_month  Benefit per order  Order Item Total  Product Card Id  Product Name  Order Item Cardprod Id  Order State  Product Category Id  order_week_day  shipping_year  Category Name  order_month  order_year  Order Item Discount  Department Name  Market  Order City  Days for shipment (scheduled)  Customer Segment  Customer Full Name       Sales
0    77202.0            20755.0       180517.0                327.750000            2.0                  1.0         73.0             2.0          91.250000        314.640015           1360.0          78.0                  1360.0        475.0                 73.0             6.0         2018.0           40.0          1.0      2018.0            13.110000              4.0     3.0       331.0                            4.0               0.0              1876.0  327.750000
1    75929.0            19482.0       179244.0                327.750000            2.0                  1.0         73.0             1.0          45.689999        268.760010           1360.0          78.0                  1360.0        267.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            59.000000              4.0     3.0      1957.0                            2.0               0.0              4257.0  327.750000
2    75928.0            19481.0       179243.0                327.750000            2.0                  1.0         73.0             1.0          21.760000        262.200012           1360.0          78.0                  1360.0        267.0                 73.0             2.0         2018.0           40.0          1.0      2018.0            65.550003              4.0     3.0      1957.0                            2.0               1.0              2170.0  327.750000
3    75905.0            19458.0       179220.0                327.750000            2.0                  1.0         73.0             1.0         152.600006        317.920013           1360.0          78.0                  1360.0        928.0                 73.0             2.0         2018.0           40.0          1.0      2018.0             9.830000              4.0     3.0      2967.0                            1.0               1.0              1071.0  327.750000
4    75900.0            19453.0       179215.0                327.750000            2.0                  1.0         73.0             1.0         143.160004        298.250000           1360.0          78.0                  1360.0        928.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            29.500000              4.0     3.0      2967.0                            0.0               0.0              3138.0  327.750000
5    75899.0            19452.0       179214.0                327.750000            2.0                  1.0         73.0             1.0         135.690002        294.980011           1360.0          78.0                  1360.0        928.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            32.779999              4.0     3.0      2967.0                            0.0               2.0              2861.0  327.750000
6    75898.0            19451.0       179213.0                327.750000            2.0                  1.0         73.0             1.0         132.669998        288.420013           1360.0          78.0                  1360.0        951.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            39.330002              4.0     3.0      2042.0                            4.0               2.0                94.0  327.750000
7    75897.0            19450.0       179212.0                327.750000            2.0                  1.0         73.0             1.0         119.760002        285.140015           1360.0          78.0                  1360.0        951.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            42.610001              4.0     3.0      2042.0                            4.0               2.0             12803.0  327.750000
8    22679.0             6951.0        56759.0                129.990005            4.0                  1.0         18.0            12.0          61.750000        123.489998            403.0          56.0                   403.0        111.0                 18.0             2.0         2015.0           34.0         11.0      2015.0             6.500000              0.0     3.0       271.0                            4.0               1.0              9485.0  129.990005
9    23610.0             6780.0        59059.0                129.990005            4.0                  1.0         18.0            12.0          38.650002        123.489998            403.0          56.0                   403.0        111.0                 18.0             0.0         2015.0           34.0         12.0      2015.0             6.500000              0.0     3.0       271.0                            4.0               1.0             12120.0  129.990005
10   24230.0             1718.0        60624.0                129.990005            4.0                  1.0         18.0            12.0          41.520000        122.839996            403.0          56.0                   403.0        196.0                 18.0             3.0         2015.0           34.0         12.0      2015.0             7.150000              0.0     3.0      1964.0                            4.0               1.0              9384.0  129.990005
11   74723.0            18276.0       178038.0                461.480011            4.0                  1.0         66.0            12.0          37.770000        429.179993           1353.0          74.0                  1353.0        474.0                 66.0             5.0         2017.0           15.0         12.0      2017.0            32.299999              0.0     3.0      2902.0                            4.0               1.0              2436.0  461.480011
12   26821.0             7795.0        67197.0                129.990005            4.0                  1.0         18.0             1.0        -193.429993        120.889999            403.0          56.0                   403.0        475.0                 18.0             6.0         2016.0           34.0          1.0      2016.0             9.100000              0.0     3.0       722.0                            4.0               1.0             12005.0  129.990005
13   77102.0            20655.0       180417.0                215.820007            4.0                  1.0         76.0             2.0          76.269997        200.710007           1363.0          81.0                  1363.0        843.0                 76.0             5.0         2018.0           48.0          1.0      2018.0            15.110000              0.0     3.0      2630.0                            4.0               1.0             13492.0  215.820007
14   75885.0            19438.0       179200.0                327.750000            2.0                  1.0         73.0             1.0         -71.300003        311.359985           1360.0          78.0                  1360.0        475.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            16.389999              4.0     3.0       269.0                            2.0               2.0              2674.0  327.750000
15   75877.0            19430.0       179192.0                327.750000            2.0                  1.0         73.0             1.0         -55.060001        275.309998           1360.0          78.0                  1360.0        502.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            52.439999              4.0     3.0       255.0                            4.0               1.0             10161.0  327.750000
16   75876.0            19429.0       179191.0                327.750000            2.0                  1.0         73.0             1.0          36.180000        272.029999           1360.0          78.0                  1360.0        502.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            55.720001              4.0     3.0       255.0                            4.0               0.0              7518.0  327.750000
17   75875.0            19428.0       179190.0                327.750000            2.0                  1.0         73.0             1.0         131.690002        268.760010           1360.0          78.0                  1360.0        502.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            59.000000              4.0     3.0       255.0                            2.0               0.0             10739.0  327.750000
18   75874.0            19427.0       179189.0                327.750000            2.0                  1.0         73.0             1.0          91.769997        262.200012           1360.0          78.0                  1360.0        502.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            65.550003              4.0     3.0       255.0                            4.0               1.0             11888.0  327.750000
19   75867.0            19420.0       179182.0                327.750000            2.0                  1.0         73.0             1.0         149.449997        311.359985           1360.0          78.0                  1360.0       1066.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            16.389999              4.0     3.0      3536.0                            0.0               2.0              2971.0  327.750000
20   75866.0            19419.0       179181.0                327.750000            2.0                  1.0         73.0             1.0          80.529999        309.720001           1360.0          78.0                  1360.0       1066.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            18.030001              4.0     3.0      3536.0                            0.0               2.0              2476.0  327.750000
21   75855.0            19408.0       179170.0                327.750000            2.0                  1.0         73.0             1.0          63.910000        245.809998           1360.0          78.0                  1360.0       1066.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            81.940002              4.0     3.0       883.0                            1.0               0.0             11751.0  327.750000
22   75854.0            19407.0       179169.0                327.750000            2.0                  1.0         73.0             1.0        -273.019989        327.750000           1360.0          78.0                  1360.0       1066.0                 73.0             0.0         2018.0           40.0          1.0      2018.0             0.000000              4.0     3.0       883.0                            2.0               0.0              7931.0  327.750000
23   75845.0            19398.0       179160.0                327.750000            2.0                  1.0         73.0             1.0          91.440002        294.980011           1360.0          78.0                  1360.0        476.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            32.779999              4.0     3.0      1946.0                            4.0               2.0              1236.0  327.750000
24   75844.0            19397.0       179159.0                327.750000            2.0                  1.0         73.0             1.0          77.870003        288.420013           1360.0          78.0                  1360.0        241.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            39.330002              4.0     3.0      1365.0                            4.0               2.0             11460.0  327.750000
25   75843.0            19396.0       179158.0                327.750000            2.0                  1.0         73.0             1.0          82.690002        285.140015           1360.0          78.0                  1360.0        241.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            42.610001              4.0     3.0      1365.0                            2.0               2.0              2310.0  327.750000
26   75842.0            19395.0       179157.0                327.750000            2.0                  1.0         73.0             1.0          69.650002        278.589996           1360.0          78.0                  1360.0        241.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            49.160000              4.0     3.0      1365.0                            4.0               2.0             10261.0  327.750000
27   75841.0            19394.0       179156.0                327.750000            2.0                  1.0         73.0             1.0         134.899994        275.309998           1360.0          78.0                  1360.0        241.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            52.439999              4.0     3.0      1365.0                            4.0               2.0             12885.0  327.750000
28   75837.0            19390.0       179152.0                327.750000            2.0                  1.0         73.0             1.0          76.940002        245.809998           1360.0          78.0                  1360.0        196.0                 73.0             0.0         2018.0           40.0          1.0      2018.0            81.940002              4.0     3.0      1964.0                            1.0               2.0              1429.0  327.750000
29   75836.0            19389.0       179151.0                327.750000            2.0                  1.0         73.0             1.0        -540.789978        327.750000           1360.0          78.0                  1360.0        196.0                 73.0             0.0         2018.0           40.0          1.0      2018.0             0.000000              4.0     3.0      1964.0                            2.0               1.0              1533.0  327.750000
torch.Size([6677, 27])
torch.Size([6677])
torch.Size([2862, 27])
torch.Size([2862])
Epoch 1/40, Loss: 40497.3707
Performance Metrics:
RMSE (test data): 147.25794860796313
MAE (test data): 107.30917020694594
MAPE (test data): 135.77338468191112
MSE (test data): 21684.903428225512
R2 (test data): -0.0795532647074908
loss (test data): 21578.827841107617
Epoch 2/40, Loss: 21992.0318
Performance Metrics:
RMSE (test data): 142.51740993679445
MAE (test data): 103.44672199380531
MAPE (test data): 134.0401842704991
MSE (test data): 20311.212135092315
R2 (test data): -0.014196252673358334
loss (test data): 20211.8561975891
Epoch 3/40, Loss: 21752.3210
Performance Metrics:
RMSE (test data): 143.00031015497964
MAE (test data): 103.88977668559953
MAPE (test data): 136.96947846210574
MSE (test data): 20449.088704420377
R2 (test data): -0.020416389931637635
loss (test data): 20349.058323506288
Epoch 4/40, Loss: 21484.9063
Performance Metrics:
RMSE (test data): 143.222876131667
MAE (test data): 103.86058747132172
MAPE (test data): 133.79502107368162
MSE (test data): 20512.792247426823
R2 (test data): -0.022343371509479848
loss (test data): 20412.449958508038
Epoch 5/40, Loss: 21676.5491
Performance Metrics:
RMSE (test data): 142.87031355874393
MAE (test data): 104.250085789501
MAPE (test data): 138.01792490525696
MSE (test data): 20411.926496373806
R2 (test data): -0.015402655012892286
loss (test data): 20312.077939378058
Epoch 6/40, Loss: 21723.6732
Performance Metrics:
RMSE (test data): 142.46915770985422
MAE (test data): 103.50633645660422
MAPE (test data): 135.8057720628726
MSE (test data): 20297.460898555317
R2 (test data): -0.007676774431882638
loss (test data): 20198.17207154088
Epoch 7/40, Loss: 21710.9905
Performance Metrics:
RMSE (test data): 142.3505905206202
MAE (test data): 103.45427542389109
MAPE (test data): 137.202133563211
MSE (test data): 20263.690621569283
R2 (test data): -0.00944570865276595
loss (test data): 20164.56708049441
Epoch 8/40, Loss: 21660.8092
Performance Metrics:
RMSE (test data): 142.6844202563765
MAE (test data): 104.33695258920112
MAPE (test data): 141.24552962895868
MSE (test data): 20358.843783898268
R2 (test data): -0.012109554449182047
loss (test data): 20259.25482617051
Epoch 9/40, Loss: 21667.5169
Performance Metrics:
RMSE (test data): 141.75100684471073
MAE (test data): 102.35764235860846
MAPE (test data): 135.3252049928121
MSE (test data): 20093.347941489228
R2 (test data): -0.0015829968396392502
loss (test data): 19995.057684748426
Epoch 10/40, Loss: 21712.4904
Performance Metrics:
RMSE (test data): 142.47844585409018
MAE (test data): 103.08183875311626
MAPE (test data): 135.78677152834146
MSE (test data): 20300.107532996906
R2 (test data): -0.009937718101976856
loss (test data): 20200.806019610412
Epoch 11/40, Loss: 21722.1946
Performance Metrics:
RMSE (test data): 142.02455644168953
MAE (test data): 102.761651421196
MAPE (test data): 134.94684504550995
MSE (test data): 20170.974632458656
R2 (test data): -0.004177563729039102
loss (test data): 20072.304682040532
Epoch 12/40, Loss: 21634.1849
Performance Metrics:
RMSE (test data): 142.4145343129419
MAE (test data): 102.82646233781
MAPE (test data): 135.91124216611018
MSE (test data): 20281.899583572103
R2 (test data): -0.009800899224942317
loss (test data): 20182.686784809575
Epoch 13/40, Loss: 21614.6975
Performance Metrics:
RMSE (test data): 142.5279529902312
MAE (test data): 103.69149809406045
MAPE (test data): 136.31713792645374
MSE (test data): 20314.217383585557
R2 (test data): -0.010190671813024244
loss (test data): 20214.84728227638
Epoch 14/40, Loss: 21619.9812
Performance Metrics:
RMSE (test data): 142.03388393206686
MAE (test data): 103.48431159472197
MAPE (test data): 136.9763475762013
MSE (test data): 20173.624184827837
R2 (test data): -0.005237809530793225
loss (test data): 20074.941059573724
Epoch 15/40, Loss: 21630.4165
Performance Metrics:
RMSE (test data): 142.24168510986465
MAE (test data): 103.84684052025334
MAPE (test data): 138.81717251347422
MSE (test data): 20232.69698289389
R2 (test data): -0.007382611294948438
loss (test data): 20133.72526860587
Epoch 16/40, Loss: 21682.3359
Performance Metrics:
RMSE (test data): 142.07575566023357
MAE (test data): 102.67984466405397
MAPE (test data): 134.0474917666638
MSE (test data): 20185.52034642639
R2 (test data): -0.0036347275015784497
loss (test data): 20086.77882053634
Traceback (most recent call last):
  File "/Users/yunbo/Documents/GitHub/PFL_Optimiozation/Local_learning/Transformer_local.py", line 239, in <module>
    loss.backward()
  File "/Users/yunbo/anaconda3/envs/basic/lib/python3.9/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/Users/yunbo/anaconda3/envs/basic/lib/python3.9/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/Users/yunbo/anaconda3/envs/basic/lib/python3.9/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt