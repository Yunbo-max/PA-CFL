    Order Id  Order Customer Id  Order Item Id  Order Item Product Price  Department Id  Order Item Quantity  Category Id  shipping_month  Benefit per order  Order Item Total  Product Card Id  Product Name  Order Item Cardprod Id  Order State  Product Category Id  order_week_day  shipping_year  Category Name  order_month  order_year  Order Item Discount  Department Name  Market  Order City  Days for shipment (scheduled)  Customer Segment  Customer Full Name       Sales
0    34773.0            11169.0        86866.0                 59.990002            4.0                  2.0         17.0             5.0          46.070000         95.980003            365.0          71.0                   365.0        510.0                 17.0             3.0         2016.0           12.0          5.0      2016.0            24.000000              0.0     4.0      2371.0                            2.0               2.0              7406.0  119.980003
1    33824.0             1509.0        84424.0                 44.990002            3.0                  3.0         13.0             5.0          28.850000        128.220001            278.0         105.0                   278.0        986.0                 13.0             3.0         2016.0           17.0          5.0      2016.0             6.750000              5.0     4.0      1380.0                            4.0               0.0             10775.0  134.970001
2    37496.0            10029.0        93579.0                 39.990002            5.0                  3.0         29.0             7.0           7.480000        118.769997            627.0         102.0                   627.0        453.0                 29.0             0.0         2016.0           38.0          7.0      2016.0             1.200000              6.0     4.0       760.0                            4.0               0.0              9374.0  119.970001
3    33824.0             1509.0        84425.0                 50.000000            5.0                  3.0         24.0             5.0          33.000000        132.000000            502.0          59.0                   502.0        986.0                 24.0             3.0         2016.0           47.0          5.0      2016.0            18.000000              6.0     4.0      1380.0                            4.0               0.0             10775.0  150.000000
4    38598.0            11018.0        96337.0                 24.990000            6.0                  3.0         40.0             7.0          36.369999         74.220001            893.0          87.0                   893.0        450.0                 40.0             3.0         2016.0            0.0          7.0      2016.0             0.750000              8.0     4.0       887.0                            4.0               0.0              1763.0   74.970001
5    37845.0             3222.0        94445.0                 15.990000            6.0                  3.0         41.0             7.0          18.129999         40.290001            924.0          32.0                   924.0        450.0                 41.0             6.0         2016.0           44.0          7.0      2016.0             7.680000              8.0     4.0       990.0                            4.0               0.0              9485.0   47.970001
6    34773.0            11169.0        86867.0                 50.000000            5.0                  3.0         24.0             5.0          66.930000        145.500000            502.0          59.0                   502.0        510.0                 24.0             3.0         2016.0           47.0          5.0      2016.0             4.500000              6.0     4.0      2371.0                            2.0               2.0              7406.0  150.000000
7    37867.0            11776.0        94512.0                 59.990002            4.0                  4.0         17.0             7.0          95.980003        191.970001            365.0          71.0                   365.0        986.0                 17.0             6.0         2016.0           12.0          7.0      2016.0            47.990002              0.0     4.0      1380.0                            2.0               2.0              9384.0  239.960007
8    37867.0            11776.0        94509.0                 59.990002            4.0                  4.0         17.0             7.0          56.330002        179.970001            365.0          71.0                   365.0        986.0                 17.0             6.0         2016.0           12.0          7.0      2016.0            59.990002              0.0     4.0      1380.0                            2.0               2.0              9384.0  239.960007
9    31697.0             1575.0        79206.0                 59.990002            4.0                  5.0         17.0             4.0         -13.320000        283.450012            365.0          71.0                   365.0        986.0                 17.0             4.0         2016.0           12.0          4.0      2016.0            16.500000              0.0     4.0      1380.0                            2.0               2.0              6267.0  299.950012
10   37276.0             5820.0        93056.0                 59.990002            4.0                  5.0         17.0             6.0          16.440001        260.959992            365.0          71.0                   365.0        760.0                 17.0             5.0         2016.0           12.0          6.0      2016.0            38.990002              0.0     4.0      3250.0                            2.0               2.0              8376.0  299.950012
11   37718.0             1627.0        94152.0                 99.989998            3.0                  5.0          9.0             7.0        -635.440002        409.959992            191.0          61.0                   191.0        760.0                  9.0             1.0         2016.0           10.0          7.0      2016.0            89.989998              5.0     4.0      3250.0                            4.0               0.0              8928.0  499.950012
12   40776.0             7200.0       101758.0                 59.990002            4.0                  5.0         17.0             8.0         -54.590000        272.950012            365.0          71.0                   365.0        450.0                 17.0             4.0         2016.0           12.0          8.0      2016.0            27.000000              0.0     4.0      2365.0                            4.0               0.0              6935.0  299.950012
13   39582.0             3142.0        98794.0                 59.990002            4.0                  5.0         17.0             8.0          98.260002        272.950012            365.0          71.0                   365.0        450.0                 17.0             3.0         2016.0           12.0          7.0      2016.0            27.000000              0.0     4.0      2744.0                            4.0               0.0              1584.0  299.950012
14   41142.0             5023.0       102700.0                 50.000000            5.0                  5.0         24.0             8.0          42.240002        240.000000            502.0          59.0                   502.0        450.0                 24.0             5.0         2016.0           47.0          8.0      2016.0            10.000000              6.0     4.0       868.0                            4.0               0.0              9384.0  250.000000
15   39991.0             3915.0        99785.0                 50.000000            5.0                  5.0         24.0             8.0          62.400002        240.000000            502.0          59.0                   502.0        667.0                 24.0             2.0         2016.0           47.0          8.0      2016.0            10.000000              6.0     4.0      1204.0                            4.0               0.0              4825.0  250.000000
16   36495.0             7894.0        91124.0                 50.000000            5.0                  5.0         24.0             6.0          25.430000        225.000000            502.0          59.0                   502.0        986.0                 24.0             4.0         2016.0           47.0          6.0      2016.0            25.000000              6.0     4.0      2719.0                            4.0               0.0              3840.0  250.000000
17   37945.0             9197.0        94721.0                 50.000000            5.0                  5.0         24.0             7.0         104.400002        217.500000            502.0          59.0                   502.0        986.0                 24.0             4.0         2016.0           47.0          7.0      2016.0            32.500000              6.0     4.0       174.0                            4.0               0.0              9413.0  250.000000
18   31738.0             9202.0        79317.0                 34.990002            2.0                  5.0          3.0             4.0         -66.480003        166.199997             37.0         113.0                    37.0        667.0                  3.0             0.0         2016.0            3.0          4.0      2016.0             8.750000              4.0     4.0       889.0                            4.0               0.0              9381.0  174.949997
19   35393.0             2922.0        88393.0                 24.990000            2.0                  5.0          5.0             6.0          51.130001        116.199997             93.0         106.0                    93.0        672.0                  5.0             5.0         2016.0           32.0          5.0      2016.0             8.750000              4.0     4.0      2095.0                            4.0               0.0              8178.0  124.949997
20   40716.0              712.0       101576.0                 99.989998            3.0                  5.0          9.0             8.0         208.779999        434.959992            191.0          61.0                   191.0        986.0                  9.0             6.0         2016.0           10.0          8.0      2016.0            64.989998              5.0     4.0      1380.0                            4.0               0.0              8655.0  499.950012
21   35393.0             2922.0        88397.0                 59.990002            4.0                  5.0         17.0             6.0         104.980003        299.950012            365.0          71.0                   365.0        672.0                 17.0             5.0         2016.0           12.0          5.0      2016.0             0.000000              0.0     4.0      2095.0                            4.0               0.0              8178.0  299.950012
22   35266.0              288.0        88070.0                 59.990002            4.0                  5.0         17.0             5.0          31.870001        254.960007            365.0          71.0                   365.0        986.0                 17.0             3.0         2016.0           12.0          5.0      2016.0            44.990002              0.0     4.0      2796.0                            4.0               0.0              6589.0  299.950012
23   34089.0             8004.0        85095.0                 59.990002            4.0                  5.0         17.0             5.0         119.830002        254.960007            365.0          71.0                   365.0        714.0                 17.0             4.0         2016.0           12.0          5.0      2016.0            44.990002              0.0     4.0      2336.0                            4.0               0.0              9384.0  299.950012
24   39241.0             2368.0        97952.0                 39.990002            5.0                  5.0         29.0             7.0          47.110001        197.949997            627.0         102.0                   627.0        986.0                 29.0             5.0         2016.0           38.0          7.0      2016.0             2.000000              6.0     4.0       845.0                            4.0               0.0              9163.0  199.949997
25   32462.0             4346.0        81187.0                 50.000000            5.0                  5.0         24.0             4.0          96.000000        200.000000            502.0          59.0                   502.0        667.0                 24.0             1.0         2016.0           47.0          4.0      2016.0            50.000000              6.0     4.0      1480.0                            4.0               0.0              5712.0  250.000000
26   31957.0             7045.0        79882.0                 17.990000            6.0                  5.0         36.0             4.0           8.550000         85.449997            797.0          40.0                   797.0        986.0                 36.0             1.0         2016.0           24.0          4.0      2016.0             4.500000              8.0     4.0       174.0                            4.0               0.0              4937.0   89.949997
27   36837.0             7330.0        91926.0                 31.990000            6.0                  5.0         37.0             6.0         -20.090000        145.550003            825.0           7.0                   825.0        450.0                 37.0             5.0         2016.0           17.0          6.0      2016.0            14.400000              8.0     4.0       683.0                            4.0               0.0              9384.0  159.949997
28   31336.0             9554.0        78334.0                 24.990000            2.0                  5.0          5.0             4.0          22.080000        116.199997             93.0         106.0                    93.0        986.0                  5.0             2.0         2016.0           32.0          4.0      2016.0             8.750000              4.0     4.0      1380.0                            4.0               0.0              8974.0  124.949997
29   31336.0             9554.0        78332.0                 47.990002            6.0                  5.0         37.0             4.0         -41.660000        191.960007            822.0          96.0                   822.0        986.0                 37.0             2.0         2016.0           17.0          4.0      2016.0            47.990002              8.0     4.0      1380.0                            4.0               0.0              8974.0  239.949997
torch.Size([4120, 27])
torch.Size([4120])
torch.Size([1767, 27])
torch.Size([1767])
Epoch 1/40, Loss: 50420.2630
Performance Metrics:
RMSE (test data): 222.2689267952169
MAE (test data): 194.78823075191625
MAPE (test data): 101.24940990998574
MSE (test data): 49403.4758186975
R2 (test data): -3.047290546124052
loss (test data): 49207.76291029994
Epoch 2/40, Loss: 48928.4302
Performance Metrics:
RMSE (test data): 217.82354242209294
MAE (test data): 193.46840251773511
MAPE (test data): 103.61789251136734
MSE (test data): 47447.09563330932
R2 (test data): -2.8791206713918567
loss (test data): 47259.13320599887
Epoch 3/40, Loss: 46738.0850
Performance Metrics:
RMSE (test data): 212.4224286795216
MAE (test data): 190.75300828741695
MAPE (test data): 105.06580805116319
MSE (test data): 45123.288206106445
R2 (test data): -2.689906493511884
loss (test data): 44944.531515280134
Epoch 4/40, Loss: 44392.3615
Performance Metrics:
RMSE (test data): 205.84603541352544
MAE (test data): 185.96559815542264
MAPE (test data): 103.90563007950564
MSE (test data): 42372.590295466376
R2 (test data): -2.4599888538789982
loss (test data): 42204.73068760611
Epoch 5/40, Loss: 41252.0986
Performance Metrics:
RMSE (test data): 197.20432329499093
MAE (test data): 178.2779377038506
MAPE (test data): 99.77972319688061
MSE (test data): 38889.5451262353
R2 (test data): -2.1719885296432277
loss (test data): 38735.48337577815
Epoch 6/40, Loss: 37423.3417
Performance Metrics:
RMSE (test data): 186.84042588831542
MAE (test data): 168.08363749527118
MAPE (test data): 92.78846747296933
MSE (test data): 34909.34474612709
R2 (test data): -1.8485318539852815
loss (test data): 34771.050473967174
Epoch 7/40, Loss: 32651.2339
Performance Metrics:
RMSE (test data): 171.51778490204842
MAE (test data): 154.1720849961381
MAPE (test data): 85.5544704127489
MSE (test data): 29418.350537705344
R2 (test data): -1.4090469661246234
loss (test data): 29301.809210526317
Epoch 8/40, Loss: 27096.0741
Performance Metrics:
RMSE (test data): 154.00184946461962
MAE (test data): 139.33916575498878
MAPE (test data): 78.57640984239738
MSE (test data): 23716.569638523368
R2 (test data): -0.9379847682234268
loss (test data): 23622.61610427278
Epoch 9/40, Loss: 21395.5521
Performance Metrics:
RMSE (test data): 135.6390096934068
MAE (test data): 124.01725695177235
MAPE (test data): 72.01852319606724
MSE (test data): 18397.940950608103
R2 (test data): -0.5016111954525648
loss (test data): 18325.057141341258
Epoch 10/40, Loss: 16327.0060
Performance Metrics:
RMSE (test data): 117.3626282408276
MAE (test data): 107.97478471750563
MAPE (test data): 64.79411945784757
MSE (test data): 13773.986507594705
R2 (test data): -0.12701652684948406
loss (test data): 13719.420610498019
Epoch 11/40, Loss: 12023.2225
Performance Metrics:
RMSE (test data): 100.01411244401363
MAE (test data): 92.90961875509132
MAPE (test data): 58.24039890401895
MSE (test data): 10002.822687963802
R2 (test data): 0.18120550203558405
loss (test data): 9963.196201188455
Epoch 12/40, Loss: 8533.1108
Performance Metrics:
RMSE (test data): 84.30157444629573
MAE (test data): 78.18241562321782
MAPE (test data): 49.75480340492022
MSE (test data): 7106.755454124342
R2 (test data): 0.4195862626269511
loss (test data): 7078.601810094793
Epoch 13/40, Loss: 6132.4842
Performance Metrics:
RMSE (test data): 69.98129406935878
MAE (test data): 64.27401839975606
MAPE (test data): 41.93043659361096
MSE (test data): 4897.38151962207
R2 (test data): 0.5997349762527595
loss (test data): 4877.9804621179965
Epoch 14/40, Loss: 4273.1033
Performance Metrics:
RMSE (test data): 58.13161276705463
MAE (test data): 52.562902646511795
MAPE (test data): 35.602807038834776
MSE (test data): 3379.284402898789
R2 (test data): 0.724006525008319
loss (test data): 3365.8972996969173
Epoch 15/40, Loss: 2853.1799
Performance Metrics:
RMSE (test data): 47.87698510120557
MAE (test data): 41.846181481263855
MAPE (test data): 28.614004130831134
MSE (test data): 2292.2057023810603
R2 (test data): 0.8118136296078471
loss (test data): 2283.1250881503784
Epoch 16/40, Loss: 1994.8514
Performance Metrics:
RMSE (test data): 36.71030457098407
MAE (test data): 32.175710716775875
MAPE (test data): 22.600091146645397
MSE (test data): 1347.646461694414
R2 (test data): 0.8898189085790755
loss (test data): 1342.3077433337312
Epoch 17/40, Loss: 1427.3455
Performance Metrics:
RMSE (test data): 33.334205978990624
MAE (test data): 27.107194066521796
MAPE (test data): 18.91625928607646
MSE (test data): 1111.1692882497741
R2 (test data): 0.9091595946624172
loss (test data): 1106.7673722565612
Epoch 18/40, Loss: 1000.2063
Performance Metrics:
RMSE (test data): 28.315338786789585
MAE (test data): 22.453193241222337
MAPE (test data): 15.180583277561905
MSE (test data): 801.7584106106707
R2 (test data): 0.9343922048740594
loss (test data): 798.582233802437
Epoch 19/40, Loss: 754.3435
Performance Metrics:
RMSE (test data): 24.80161086119855
MAE (test data): 20.09120551371439
MAPE (test data): 14.139178404939749
MSE (test data): 615.119901310322
R2 (test data): 0.949667477879415
loss (test data): 612.6830854345731
Epoch 20/40, Loss: 646.5323
Performance Metrics:
RMSE (test data): 23.531603400940014
MAE (test data): 18.3293307678266
MAPE (test data): 11.97913447357329
MSE (test data): 553.7363586191316
R2 (test data): 0.9545856575834121
loss (test data): 551.5427150067868
Epoch 21/40, Loss: 600.8610
Performance Metrics:
RMSE (test data): 23.57439610612208
MAE (test data): 18.16709228232503
MAPE (test data): 11.665826045493084
MSE (test data): 555.7521517683439
R2 (test data): 0.954440979191198
loss (test data): 553.5505373166251
Epoch 22/40, Loss: 514.9304
Performance Metrics:
RMSE (test data): 23.362530277450894
MAE (test data): 17.83699777072126
MAPE (test data): 11.650555574362018
MSE (test data): 545.8078209648097
R2 (test data): 0.9554354946588313
loss (test data): 543.6455903671256
Epoch 23/40, Loss: 564.5772
Performance Metrics:
RMSE (test data): 24.930220417291544
MAE (test data): 19.549977590617807
MAPE (test data): 13.233531014537759
MSE (test data): 621.5158900547402
R2 (test data): 0.9490550235608419
loss (test data): 619.0537315243439
Epoch 24/40, Loss: 536.1999
Performance Metrics:
RMSE (test data): 21.214444620315565
MAE (test data): 16.58410747159611
MAPE (test data): 11.435257686621005
MSE (test data): 450.05266054843594
R2 (test data): 0.9631977823147146
loss (test data): 448.26976734241254
Epoch 25/40, Loss: 604.2047
Performance Metrics:
RMSE (test data): 21.78318723033256
MAE (test data): 16.078438433462924
MAPE (test data): 11.188812639519776
MSE (test data): 474.50724591172354
R2 (test data): 0.9612070533400672
loss (test data): 472.6274833743965
Epoch 26/40, Loss: 568.6615
Performance Metrics:
RMSE (test data): 22.586372387291025
MAE (test data): 17.941408504139293
MAPE (test data): 12.309806411984713
MSE (test data): 510.14421761738254
R2 (test data): 0.9582903544590828
loss (test data): 508.12327167228176
Epoch 27/40, Loss: 476.8219
Performance Metrics:
RMSE (test data): 23.651889755599257
MAE (test data): 18.38453731350601
MAPE (test data): 13.009107746458099
MSE (test data): 559.4118890110211
R2 (test data): 0.9543698025100954
loss (test data): 557.1957639598145
Epoch 28/40, Loss: 527.9727
Performance Metrics:
RMSE (test data): 21.803683956174304
MAE (test data): 16.61350847049193
MAPE (test data): 11.986806663813908
MSE (test data): 475.40063406073267
R2 (test data): 0.9610585916862924
loss (test data): 473.51733059928995
Epoch 29/40, Loss: 574.9799
Performance Metrics:
RMSE (test data): 23.665468504429708
MAE (test data): 18.20172614346851
MAPE (test data): 13.566817688331156
MSE (test data): 560.0543995341544
R2 (test data): 0.9542204431325971
loss (test data): 557.8357332204787
Epoch 30/40, Loss: 537.3271
Performance Metrics:
RMSE (test data): 19.56375340175943
MAE (test data): 15.153442544286902
MAPE (test data): 11.077506667009311
MSE (test data): 382.74044716485366
R2 (test data): 0.9687297215539727
loss (test data): 381.22420720616907
Epoch 31/40, Loss: 491.7084
Performance Metrics:
RMSE (test data): 18.51126764495505
MAE (test data): 14.274123491617766
MAPE (test data): 10.352268099238508
MSE (test data): 342.6670298231597
R2 (test data): 0.9719863166390804
loss (test data): 341.3095465823628
Epoch 32/40, Loss: 640.0297
Performance Metrics:
RMSE (test data): 24.206932303828637
MAE (test data): 19.060702630064704
MAPE (test data): 13.5484215174326
MSE (test data): 585.9755715621425
R2 (test data): 0.95201107865185
loss (test data): 583.6542215395864
Epoch 33/40, Loss: 456.7234
Performance Metrics:
RMSE (test data): 22.788388259458053
MAE (test data): 17.949084487896073
MAPE (test data): 11.750465855932129
MSE (test data): 519.3106394638056
R2 (test data): 0.9574353820283272
loss (test data): 517.2533758969785
Epoch 34/40, Loss: 490.7914
Performance Metrics:
RMSE (test data): 23.214004905691205
MAE (test data): 18.42002986283465
MAPE (test data): 14.129728583646445
MSE (test data): 538.8900237614554
R2 (test data): 0.955920514851128
loss (test data): 536.7552067789576
Epoch 35/40, Loss: 474.7962
Performance Metrics:
RMSE (test data): 23.35750973781105
MAE (test data): 19.28819681162184
MAPE (test data): 14.529751421729554
MSE (test data): 545.573261151938
R2 (test data): 0.9553784334389279
loss (test data): 543.4119741097641
Epoch 36/40, Loss: 670.0920
Performance Metrics:
RMSE (test data): 21.564557360283935
MAE (test data): 16.69263951724226
MAPE (test data): 12.084982911357933
MSE (test data): 465.03013414497605
R2 (test data): 0.9620199318490958
loss (test data): 463.18790848995917
Epoch 37/40, Loss: 540.4624
Performance Metrics:
RMSE (test data): 23.599826331183447
MAE (test data): 18.718811503730038
MAPE (test data): 13.056115384395808
MSE (test data): 556.9518028620196
R2 (test data): 0.9545243876681325
loss (test data): 554.7454341765373
Epoch 38/40, Loss: 424.1901
Performance Metrics:
RMSE (test data): 20.059883825738776
MAE (test data): 15.611706818233836
MAPE (test data): 10.90054762466663
MSE (test data): 402.3989391021362
R2 (test data): 0.9671546555732377
loss (test data): 400.80482335244454
Epoch 39/40, Loss: 447.4088
Performance Metrics:
RMSE (test data): 25.53336533155639
MAE (test data): 20.064454619315537
MAPE (test data): 14.081553319676926
MSE (test data): 651.9527451547258
R2 (test data): 0.946774320357512
loss (test data): 649.3700271027872
Epoch 40/40, Loss: 484.6456
Performance Metrics:
RMSE (test data): 21.997154758374563
MAE (test data): 17.872415281967683
MAPE (test data): 12.983800617270438
MSE (test data): 483.87481746388073
R2 (test data): 0.9603720957616264
loss (test data): 481.95794121613255